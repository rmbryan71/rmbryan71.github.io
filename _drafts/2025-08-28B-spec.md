---
layout: post
title:  "Inferring Protein from Spectrum"
date:   2025-08-28
---

[This](https://rosalind.info/problems/spec/) problem asks:

> **Given**: A list L of n (n≤100) positive real numbers.

> **Return**: A protein string of length n−1 whose prefix spectrum is equal to L.

<!--break-->

# References
1. [Real numbers](https://en.wikipedia.org/wiki/Real_number)
2. [Mass spectrum](https://en.wikipedia.org/wiki/Mass_spectrum)
3. [Prefix spectrum](https://rosalind.info/glossary/prefix-spectrum/)
4. [Monoisotopic mass table](https://rosalind.info/glossary/prefix-spectrum/)
5. [stackoverflow on "Get key by value in dictionary"](https://stackoverflow.com/questions/8023306/get-key-by-value-in-dictionary)

# Restate the problem
I'm going to get a list of weights and I need to find the differences between those weights. Then I need to look those differences up in the dictionary of masses and find the corresponding proteins.

# Solution steps
Looking up the keys of the dictionary based on the values was more difficult than I expected. My solution uses this syntax:
```python
list(rounded_dict.keys())[list(rounded_dict.values()).index(j)]
```
This separates all of the values in the dictionary into a list, finds the position of the desired value and returns the key at that position. It might have been easier just to rewrite the dictionary so that the weights were the keys.

I found that I had to round the differences between the weights and the weights in the dictionary to 2 decimal places to get reliable matches. As a result, I had to build a second dictionary with rounded values as keys and my lookup routine is:
```python
for i in range(1, len(L)):
    j = round((L[i] - L[i-1]), 2)
    print(list(rounded_dict.keys())[list(rounded_dict.values()).index(j)], end='')
```

I got a correct result on my first attempt. The protein string was long. Specifically, it was "IVYQTQCQKPGKSPYAKFDGFYREVAGGDHCWDGEECIIGTFEWGKDEWRHTPQNRATFTGPKKMFWSIIEMDWQFHVII", 80 characters long.

This was my 54th correct result. I was the first person to solve this challenge today. 1,822 people have solved this before me. I spent about 90 minutes on this, and nearly all of that was focused on the small differences between the weight differences in the prefix spectra and the lookup table.

Curiously enough, after I solved the challenge, when I looked at the explanation, they rewrote the dictionary so that the values are the key and the keys are the values exactly like I had mentioned.