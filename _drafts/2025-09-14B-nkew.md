---
layout: post
title:  "Newick Format with Edge Weights"
date:   2025-07-18
---

[This](https://rosalind.info/problems/nkew/) problem asks:

> **Given**: A collection of _n_ weighted trees (_n_â‰¤40) in Newick format, with each tree containing at most 200 nodes; each tree _Tk_ is followed by a pair of nodes _xk_ and _yk_ in _Tk_.

> **Return**: A collection of _n_ numbers, for which the *k*th number represents the distance between _xk_ and _yk_ in _Tk_.

<!--break-->

# References
1. [Weighted graph](https://rosalind.info/glossary/weighted-graph/)
2. [Edge weight](https://rosalind.info/glossary/edge-weight/)
3. [Newick format](https://rosalind.info/glossary/newick-format/)

# Restating the problem
I'm going to get a collection of up to 40 weighted trees in Newick format. With each tree, I'm also going to get two named nodes. I need to find the distances between all of the named nodes in the weighted trees.

# Solution steps
First, I copied my code from the "[Distances in Trees](https://rosalind.info/problems/nwck/)" challenge, which also used the Newick format.

The only two differences between this challenge and the previous challenge are:
1. This challenge includes 40 trees of up to 200 nodes each, where the first challenge was a single tree of up to 40 nodes.
2. This challenge includes the consideration of weighted edges.

A refactoring of my code from the previous challenge resulted in:

```python
if __name__ == "__main__":
    file_path = "/Users/robertbryan/Downloads/rosalind_nkew_sample.txt"
    with open(file_path, "r") as f:
        flines = f.readlines()
        for i in range(0, len(flines), 3):
            handle = StringIO(flines[i].rstrip())
            tree = Phylo.read(handle, 'newick')
            x, y = flines[i+1].rstrip().split()
            print(int(tree.distance(x,y)), end=' ')
```

This returned a correct result for the sample dataset.




# Python concepts

# Bioinformatics concepts

# Post-solution notes
**Challenges solved so far:** 

**How many people solved this before me:** 

**Most recent solve before me:** 

**Time spent on challenge:** 

**Most time-consuming facet:** 

**Questions from others:** 

**Solutions from others:**

**Problem explanation:** 

**Accomplishments and badges:** 

**Closing thoughts:** 