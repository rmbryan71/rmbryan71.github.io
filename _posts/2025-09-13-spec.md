---
layout: post
title:  "Inferring Protein from Spectrum"
date:   2025-09-13
---

[This](https://rosalind.info/problems/spec/) problem asks:

> **Given**: A list _L_ of _n_ (_n_≤100) positive real numbers.

> **Return**: A protein string of length _n_−1 whose prefix spectrum is equal to _L_.

<!--break-->

# References
1. [Real numbers](https://en.wikipedia.org/wiki/Real_number)
2. [Mass spectrum](https://en.wikipedia.org/wiki/Mass_spectrum)
3. [Prefix spectrum](https://rosalind.info/glossary/prefix-spectrum/)
4. [Monoisotopic mass table](https://rosalind.info/glossary/prefix-spectrum/)
5. [stackoverflow on "Get key by value in dictionary"](https://stackoverflow.com/questions/8023306/get-key-by-value-in-dictionary)

# Restate the problem
I'm going to get a list of weights. I need to find the differences between those weights. Then I need to look those differences up in the dictionary of masses and find the corresponding proteins.

# Solution steps
Looking up the keys of the dictionary based on the values was more difficult than I expected. My solution uses this syntax:

```python
list(rounded_dict.keys())[list(rounded_dict.values()).index(j)]
```

This separates all the values in the dictionary into a list, finds the position of the desired value and returns the key at that position. It might have been easier just to rewrite the dictionary so that the weights were the keys.

I found that I had to round the differences between the weights and the weights in the dictionary to 2 decimal places to get reliable matches. As a result, I had to build a second dictionary with rounded values as keys and my lookup routine was:

```python
for i in range(1, len(L)):
    j = round((L[i] - L[i-1]), 2)
    print(list(rounded_dict.keys())[list(rounded_dict.values()).index(j)], end='')
```

I got a correct result on my first attempt. The protein string was long. Specifically, it was "IVYQTQCQKPGKSPYAKFDGFYREVAGGDHCWDGEECIIGTFEWGKDEWRHTPQNRATFTGPKKMFWSIIEMDWQFHVII", 80 characters long.

# Post-solution notes
**Challenges solved so far:** 54

**How many people solved this before me:** 1,822

**Most recent solve before me:** yesterday

**Time spent on challenge:** 90 minutes

**Most time-consuming facet:** rounding the differences between the weights and finding a way to look up dictionary keys based on values

**Problem explanation:** The explanation included reversing the keys and values in the dictionary.